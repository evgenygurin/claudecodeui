# API —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Claude Code UI

## üåê –û–±–∑–æ—Ä API –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

Claude Code UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RESTful API —Å WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –¥–ª—è real-time –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É frontend –∏ backend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API endpoints

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/api/auth`)

#### **POST /api/auth/login**
```javascript
// Request
{
  "username": "string",
  "password": "string"
}

// Response
{
  "token": "jwt_token",
  "user": {
    "id": "string",
    "username": "string",
    "email": "string"
  }
}
```

#### **POST /api/auth/logout**
```javascript
// Headers: Authorization: Bearer <token>
// Response: 200 OK
```

#### **GET /api/auth/me**
```javascript
// Headers: Authorization: Bearer <token>
// Response
{
  "user": {
    "id": "string",
    "username": "string",
    "email": "string",
    "preferences": {}
  }
}
```

### üìÅ –ü—Ä–æ–µ–∫—Ç—ã (`/api/projects`)

#### **GET /api/projects**
```javascript
// Response
{
  "projects": [
    {
      "id": "string",
      "name": "string",
      "path": "string",
      "type": "claude|cursor|codegen",
      "lastActivity": "ISO_date",
      "status": "active|inactive",
      "sessionsCount": "number"
    }
  ]
}
```

#### **POST /api/projects**
```javascript
// Request
{
  "name": "string",
  "path": "string",
  "type": "claude|cursor|codegen",
  "config": {}
}

// Response
{
  "project": {
    "id": "string",
    "name": "string",
    "path": "string",
    "type": "string",
    "createdAt": "ISO_date"
  }
}
```

#### **PUT /api/projects/:id**
```javascript
// Request
{
  "name": "string",
  "config": {}
}

// Response: Updated project object
```

#### **DELETE /api/projects/:id**
```javascript
// Response: 204 No Content
```

### üí¨ –°–µ—Å—Å–∏–∏ (`/api/sessions`)

#### **GET /api/projects/:projectId/sessions**
```javascript
// Response
{
  "sessions": [
    {
      "id": "string",
      "projectId": "string",
      "name": "string",
      "type": "chat|terminal",
      "status": "active|completed|aborted",
      "createdAt": "ISO_date",
      "lastActivity": "ISO_date",
      "messagesCount": "number"
    }
  ]
}
```

#### **POST /api/projects/:projectId/sessions**
```javascript
// Request
{
  "name": "string",
  "type": "chat|terminal",
  "config": {}
}

// Response: New session object
```

#### **GET /api/sessions/:sessionId/messages**
```javascript
// Query params: ?page=1&limit=50
// Response
{
  "messages": [
    {
      "id": "string",
      "sessionId": "string",
      "type": "user|assistant|system",
      "content": "string",
      "timestamp": "ISO_date",
      "metadata": {}
    }
  ],
  "pagination": {
    "page": "number",
    "limit": "number",
    "total": "number",
    "hasMore": "boolean"
  }
}
```

#### **POST /api/sessions/:sessionId/messages**
```javascript
// Request
{
  "content": "string",
  "type": "user",
  "attachments": [
    {
      "type": "file|image",
      "name": "string",
      "content": "base64|url"
    }
  ]
}

// Response: New message object
```

### üìÇ –§–∞–π–ª—ã (`/api/files`)

#### **GET /api/projects/:projectId/files**
```javascript
// Query params: ?path=/src&recursive=true
// Response
{
  "files": [
    {
      "name": "string",
      "path": "string",
      "type": "file|directory",
      "size": "number",
      "modified": "ISO_date",
      "gitStatus": "modified|added|deleted|untracked"
    }
  ]
}
```

#### **GET /api/projects/:projectId/files/content**
```javascript
// Query params: ?path=/src/App.jsx
// Response
{
  "content": "string",
  "encoding": "utf8|base64",
  "metadata": {
    "size": "number",
    "modified": "ISO_date",
    "language": "javascript"
  }
}
```

#### **PUT /api/projects/:projectId/files/content**
```javascript
// Request
{
  "path": "string",
  "content": "string",
  "encoding": "utf8"
}

// Response: 200 OK
```

#### **POST /api/projects/:projectId/files**
```javascript
// Request
{
  "path": "string",
  "type": "file|directory",
  "content": "string" // for files only
}

// Response: Created file/directory object
```

#### **DELETE /api/projects/:projectId/files**
```javascript
// Query params: ?path=/src/unused.js
// Response: 204 No Content
```

### üîß Git –æ–ø–µ—Ä–∞—Ü–∏–∏ (`/api/git`)

#### **GET /api/projects/:projectId/git/status**
```javascript
// Response
{
  "branch": "string",
  "status": {
    "modified": ["file1.js", "file2.js"],
    "added": ["file3.js"],
    "deleted": ["file4.js"],
    "untracked": ["file5.js"]
  },
  "ahead": "number",
  "behind": "number"
}
```

#### **POST /api/projects/:projectId/git/commit**
```javascript
// Request
{
  "message": "string",
  "files": ["file1.js", "file2.js"]
}

// Response
{
  "commitHash": "string",
  "message": "string",
  "timestamp": "ISO_date"
}
```

#### **GET /api/projects/:projectId/git/log**
```javascript
// Query params: ?limit=10&offset=0
// Response
{
  "commits": [
    {
      "hash": "string",
      "message": "string",
      "author": "string",
      "timestamp": "ISO_date",
      "files": ["string"]
    }
  ]
}
```

### üìã TaskMaster (`/api/taskmaster`)

#### **GET /api/projects/:projectId/tasks**
```javascript
// Response
{
  "tasks": [
    {
      "id": "string",
      "title": "string",
      "description": "string",
      "status": "todo|in_progress|done",
      "priority": "low|medium|high",
      "assignee": "string",
      "dueDate": "ISO_date",
      "createdAt": "ISO_date"
    }
  ]
}
```

#### **POST /api/projects/:projectId/tasks**
```javascript
// Request
{
  "title": "string",
  "description": "string",
  "priority": "low|medium|high",
  "dueDate": "ISO_date"
}

// Response: New task object
```

#### **PUT /api/tasks/:taskId**
```javascript
// Request
{
  "status": "todo|in_progress|done",
  "assignee": "string"
}

// Response: Updated task object
```

#### **GET /api/projects/:projectId/prd**
```javascript
// Response
{
  "files": [
    {
      "name": "string",
      "path": "string",
      "content": "string",
      "lastModified": "ISO_date"
    }
  ]
}
```

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (`/api/settings`)

#### **GET /api/settings**
```javascript
// Response
{
  "settings": {
    "theme": "light|dark|auto",
    "language": "en|ru",
    "notifications": {
      "updates": "boolean",
      "tasks": "boolean",
      "errors": "boolean"
    },
    "cli": {
      "claude": {
        "path": "string",
        "enabled": "boolean"
      },
      "cursor": {
        "path": "string",
        "enabled": "boolean"
      },
      "codegen": {
        "apiKey": "string",
        "enabled": "boolean"
      }
    }
  }
}
```

#### **PUT /api/settings**
```javascript
// Request: Partial settings object
// Response: Updated settings object
```

## üîå WebSocket API

### **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**
```javascript
// URL: ws://localhost:3001/ws
// Headers: Authorization: Bearer <token>
```

### **–°–æ–±—ã—Ç–∏—è (Client ‚Üí Server)**

#### **join_project**
```javascript
{
  "type": "join_project",
  "projectId": "string"
}
```

#### **send_message**
```javascript
{
  "type": "send_message",
  "sessionId": "string",
  "content": "string",
  "attachments": []
}
```

#### **abort_session**
```javascript
{
  "type": "abort_session",
  "sessionId": "string"
}
```

### **–°–æ–±—ã—Ç–∏—è (Server ‚Üí Client)**

#### **project_updated**
```javascript
{
  "type": "project_updated",
  "projectId": "string",
  "data": {
    "files": [],
    "sessions": []
  }
}
```

#### **message_received**
```javascript
{
  "type": "message_received",
  "sessionId": "string",
  "message": {
    "id": "string",
    "content": "string",
    "type": "assistant",
    "timestamp": "ISO_date"
  }
}
```

#### **session_status_changed**
```javascript
{
  "type": "session_status_changed",
  "sessionId": "string",
  "status": "active|completed|aborted"
}
```

#### **typing_indicator**
```javascript
{
  "type": "typing_indicator",
  "sessionId": "string",
  "isTyping": "boolean"
}
```

## üîß CLI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### **Claude CLI**
```javascript
// Spawn process
spawn('claude', ['chat', '--project', projectPath], {
  cwd: projectPath,
  env: process.env
});

// Message format
{
  "role": "user|assistant",
  "content": "string",
  "timestamp": "ISO_date"
}
```

### **Cursor CLI**
```javascript
// Spawn process
spawn('cursor', ['--chat', '--project', projectPath], {
  cwd: projectPath,
  env: process.env
});

// Message format
{
  "type": "user_message|assistant_response",
  "content": "string",
  "metadata": {}
}
```

### **Codegen CLI**
```javascript
// API integration
const response = await fetch('https://api.codegen.com/v1/chat', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${apiKey}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    message: content,
    project: projectId
  })
});
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫**
```javascript
{
  "error": {
    "code": "string",
    "message": "string",
    "details": {},
    "timestamp": "ISO_date"
  }
}
```

### **HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã**
- `200` - Success
- `201` - Created
- `204` - No Content
- `400` - Bad Request
- `401` - Unauthorized
- `403` - Forbidden
- `404` - Not Found
- `409` - Conflict
- `422` - Unprocessable Entity
- `500` - Internal Server Error

### **WebSocket –æ—à–∏–±–∫–∏**
```javascript
{
  "type": "error",
  "error": {
    "code": "string",
    "message": "string"
  }
}
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
- JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- Refresh token –º–µ—Ö–∞–Ω–∏–∑–º
- Secure HTTP-only cookies –¥–ª—è –≤–µ–±-–∫–ª–∏–µ–Ω—Ç–æ–≤

### **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- Role-based access control (RBAC)
- Project-level permissions
- API rate limiting

### **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```javascript
// –ü—Ä–∏–º–µ—Ä middleware –≤–∞–ª–∏–¥–∞—Ü–∏–∏
const validateProject = (req, res, next) => {
  const { name, path, type } = req.body;
  
  if (!name || name.length < 1) {
    return res.status(400).json({
      error: { code: 'INVALID_NAME', message: 'Project name is required' }
    });
  }
  
  if (!['claude', 'cursor', 'codegen'].includes(type)) {
    return res.status(400).json({
      error: { code: 'INVALID_TYPE', message: 'Invalid project type' }
    });
  }
  
  next();
};
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–ú–µ—Ç—Ä–∏–∫–∏ API**
- Request/response –≤—Ä–µ–º–µ–Ω–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ endpoints
- –û—à–∏–±–∫–∏ –∏ –∏—Ö —á–∞—Å—Ç–æ—Ç–∞
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
```javascript
// –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
{
  "timestamp": "ISO_date",
  "level": "info|warn|error",
  "message": "string",
  "metadata": {
    "userId": "string",
    "projectId": "string",
    "endpoint": "string",
    "duration": "number"
  }
}
```

## üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É API

### **1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API**
```javascript
// –¢–µ–∫—É—â–µ–µ: /api/projects
// –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ: /api/v1/projects
```

### **2. –ü–∞–≥–∏–Ω–∞—Ü–∏—è**
```javascript
// –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è
{
  "data": [],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "totalPages": 5,
    "hasNext": true,
    "hasPrev": false
  }
}
```

### **3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**
```javascript
// GET /api/v1/projects?filter[type]=claude&sort=-lastActivity&limit=10
```

### **4. Batch –æ–ø–µ—Ä–∞—Ü–∏–∏**
```javascript
// POST /api/v1/projects/batch
{
  "operations": [
    { "method": "DELETE", "id": "project1" },
    { "method": "UPDATE", "id": "project2", "data": {} }
  ]
}
```

### **5. GraphQL –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
```javascript
// –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏
query GetProjectWithSessions($projectId: ID!) {
  project(id: $projectId) {
    id
    name
    sessions {
      id
      name
      messagesCount
    }
  }
}
```

### **6. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```javascript
// Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
// ETags –¥–ª—è —É—Å–ª–æ–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
// Cache-Control headers
```

### **7. Rate Limiting**
```javascript
// –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ endpoints
const rateLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // limit each IP to 100 requests per windowMs
  message: 'Too many requests from this IP'
});
```

–≠—Ç–∞ API —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è Claude Code UI —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
