# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ Claude Code UI.

## üéØ –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü—Ä–æ–±–ª–µ–º—ã

- **–ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –≤–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- **–°–º–µ—à–∞–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** - UI –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** - –ø–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –≤ CLI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è—Ö
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π** - –ø—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å API –∏ WebSocket

## üöÄ –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ   API Gateway   ‚îÇ    ‚îÇ   Microservices ‚îÇ
‚îÇ   (React SPA)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (Express)     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ   WebSocket     ‚îÇ
                       ‚îÇ   Hub           ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

#### 2.1 Auth Service

```typescript
// services/auth.service.ts
export class AuthService {
  async login(credentials: LoginCredentials): Promise<AuthResult> {
    // JWT —Ç–æ–∫–µ–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
  }
  
  async refreshToken(token: string): Promise<string> {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  }
  
  async logout(token: string): Promise<void> {
    // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
  }
}
```

#### 2.2 Project Service

```typescript
// services/project.service.ts
export class ProjectService {
  async getProjects(): Promise<Project[]> {
    // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
    // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    // –í–æ–∑–≤—Ä–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  }
  
  async createProject(data: CreateProjectDto): Promise<Project> {
    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
  }
  
  async deleteProject(id: string): Promise<void> {
    // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
    // –û—á–∏—Å—Ç–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  }
}
```

#### 2.3 Chat Service

```typescript
// services/chat.service.ts
export class ChatService {
  async sendMessage(
    sessionId: string, 
    message: string, 
    provider: AIProvider
  ): Promise<ChatResponse> {
    // –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É CLI
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏
  }
  
  async getSessionHistory(sessionId: string): Promise<Message[]> {
    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
  }
}
```

### 3. Repository Pattern

#### 3.1 Project Repository

```typescript
// repositories/project.repository.ts
export interface ProjectRepository {
  findAll(): Promise<Project[]>;
  findById(id: string): Promise<Project | null>;
  findByPath(path: string): Promise<Project | null>;
  create(project: CreateProjectDto): Promise<Project>;
  update(id: string, project: UpdateProjectDto): Promise<Project>;
  delete(id: string): Promise<void>;
}

export class FileSystemProjectRepository implements ProjectRepository {
  async findAll(): Promise<Project[]> {
    // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ~/.claude/projects/
    // –ü–∞—Ä—Å–∏–Ω–≥ JSONL —Ñ–∞–π–ª–æ–≤
    // –í–æ–∑–≤—Ä–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  }
  
  async findById(id: string): Promise<Project | null> {
    // –ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ ID
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
}
```

#### 3.2 Session Repository

```typescript
// repositories/session.repository.ts
export interface SessionRepository {
  findByProjectId(projectId: string): Promise<Session[]>;
  findById(id: string): Promise<Session | null>;
  create(session: CreateSessionDto): Promise<Session>;
  update(id: string, session: UpdateSessionDto): Promise<Session>;
  delete(id: string): Promise<void>;
}

export class ClaudeSessionRepository implements SessionRepository {
  async findByProjectId(projectId: string): Promise<Session[]> {
    // –ß—Ç–µ–Ω–∏–µ JSONL —Ñ–∞–π–ª–æ–≤
    // –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π
    // –í–æ–∑–≤—Ä–∞—Ç —Å–µ—Å—Å–∏–π
  }
  
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
}
```

### 4. CLI Provider Abstraction

#### 4.1 –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```typescript
// providers/base.provider.ts
export abstract class CLIProvider {
  abstract spawn(
    command: string, 
    options: SpawnOptions
  ): Promise<CLIProcess>;
  
  abstract abort(sessionId: string): boolean;
  
  abstract getStatus(): ProviderStatus;
  
  abstract getSessions(projectPath: string): Promise<Session[]>;
}

export interface SpawnOptions {
  projectPath: string;
  sessionId?: string;
  resume?: boolean;
  model?: string;
  outputFormat?: string;
}

export interface CLIProcess {
  id: string;
  stdout: ReadableStream;
  stderr: ReadableStream;
  stdin: WritableStream;
  kill(): void;
  onExit(callback: (code: number) => void): void;
}
```

#### 4.2 Claude Provider

```typescript
// providers/claude.provider.ts
export class ClaudeProvider extends CLIProvider {
  async spawn(command: string, options: SpawnOptions): Promise<CLIProcess> {
    const args = this.buildArgs(command, options);
    const process = spawn('claude', args, {
      cwd: options.projectPath,
      env: { ...process.env, ...this.getEnvironment() }
    });
    
    return new ClaudeProcess(process);
  }
  
  private buildArgs(command: string, options: SpawnOptions): string[] {
    const args = [];
    
    if (options.resume && options.sessionId) {
      args.push('--resume', options.sessionId);
    }
    
    if (options.model) {
      args.push('--model', options.model);
    }
    
    if (options.outputFormat) {
      args.push('--output-format', options.outputFormat);
    }
    
    if (command) {
      args.push(command);
    }
    
    return args;
  }
  
  async getSessions(projectPath: string): Promise<Session[]> {
    // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ~/.claude/projects/
    // –ü–∞—Ä—Å–∏–Ω–≥ JSONL —Ñ–∞–π–ª–æ–≤
    // –í–æ–∑–≤—Ä–∞—Ç —Å–µ—Å—Å–∏–π
  }
}
```

#### 4.3 Cursor Provider

```typescript
// providers/cursor.provider.ts
export class CursorProvider extends CLIProvider {
  async spawn(command: string, options: SpawnOptions): Promise<CLIProcess> {
    // –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
    // –í–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏ –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
    throw new Error('Cursor CLI chat interface is not available');
  }
  
  async getSessions(projectPath: string): Promise<Session[]> {
    // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ~/.cursor/chats/
    // –ß—Ç–µ–Ω–∏–µ SQLite –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
    // –í–æ–∑–≤—Ä–∞—Ç —Å–µ—Å—Å–∏–π
  }
}
```

### 5. Event-Driven Architecture

#### 5.1 Event Bus

```typescript
// events/event-bus.ts
export class EventBus {
  private listeners = new Map<string, Function[]>();
  
  on(event: string, callback: Function): void {
    if (!this.listeners.has(event)) {
      this.listeners.set(event, []);
    }
    this.listeners.get(event)!.push(callback);
  }
  
  emit(event: string, data: any): void {
    const callbacks = this.listeners.get(event) || [];
    callbacks.forEach(callback => callback(data));
  }
  
  off(event: string, callback: Function): void {
    const callbacks = this.listeners.get(event) || [];
    const index = callbacks.indexOf(callback);
    if (index > -1) {
      callbacks.splice(index, 1);
    }
  }
}
```

#### 5.2 Events

```typescript
// events/events.ts
export interface ProjectCreatedEvent {
  type: 'project.created';
  data: {
    project: Project;
    timestamp: Date;
  };
}

export interface SessionStartedEvent {
  type: 'session.started';
  data: {
    sessionId: string;
    projectId: string;
    provider: AIProvider;
    timestamp: Date;
  };
}

export interface MessageReceivedEvent {
  type: 'message.received';
  data: {
    sessionId: string;
    message: Message;
    timestamp: Date;
  };
}
```

### 6. Dependency Injection

#### 6.1 Container

```typescript
// di/container.ts
export class Container {
  private services = new Map<string, any>();
  
  register<T>(token: string, factory: () => T): void {
    this.services.set(token, factory);
  }
  
  resolve<T>(token: string): T {
    const factory = this.services.get(token);
    if (!factory) {
      throw new Error(`Service ${token} not found`);
    }
    return factory();
  }
}

// di/tokens.ts
export const TOKENS = {
  PROJECT_REPOSITORY: 'ProjectRepository',
  SESSION_REPOSITORY: 'SessionRepository',
  CLAUDE_PROVIDER: 'ClaudeProvider',
  CURSOR_PROVIDER: 'CursorProvider',
  EVENT_BUS: 'EventBus',
} as const;
```

#### 6.2 Service Registration

```typescript
// di/register-services.ts
export function registerServices(container: Container): void {
  // Repositories
  container.register(TOKENS.PROJECT_REPOSITORY, () => 
    new FileSystemProjectRepository()
  );
  
  container.register(TOKENS.SESSION_REPOSITORY, () => 
    new ClaudeSessionRepository()
  );
  
  // Providers
  container.register(TOKENS.CLAUDE_PROVIDER, () => 
    new ClaudeProvider()
  );
  
  container.register(TOKENS.CURSOR_PROVIDER, () => 
    new CursorProvider()
  );
  
  // Services
  container.register('ProjectService', () => 
    new ProjectService(
      container.resolve(TOKENS.PROJECT_REPOSITORY),
      container.resolve(TOKENS.EVENT_BUS)
    )
  );
}
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–ª–∞–Ω

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1 –Ω–µ–¥–µ–ª—è)

1. –°–æ–∑–¥–∞–Ω–∏–µ TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESLint –∏ Prettier
3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫

### –≠—Ç–∞–ø 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤ (2 –Ω–µ–¥–µ–ª–∏)

1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Repository pattern
3. –°–æ–∑–¥–∞–Ω–∏–µ CLI Provider –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1 –Ω–µ–¥–µ–ª—è)

1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (1 –Ω–µ–¥–µ–ª—è)

1. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π
3. –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–£–ª—É—á—à–µ–Ω–∏–µ maintainability** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ testability** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è** - –ª–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- **–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [02-performance.md](./02-performance.md) - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [05-code-quality.md](./05-code-quality.md) - –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [06-implementation.md](./06-implementation.md) - –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
