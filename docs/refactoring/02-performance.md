# ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Claude Code UI –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞.

## üéØ –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Frontend

- **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–æ–µ–∫—Ç–æ–≤
- **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ã** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞** –±–µ–∑ code splitting
- **–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ WebSocket** —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### Backend

- **–ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

## üöÄ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. Frontend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### 1.1 Code Splitting –∏ Lazy Loading

```typescript
// Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
const ChatInterface = lazy(() => import('./components/ChatInterface'));
const FileTree = lazy(() => import('./components/FileTree'));
const GitPanel = lazy(() => import('./components/GitPanel'));
const TaskMaster = lazy(() => import('./components/TaskMaster'));

// Route-based code splitting
const App = () => (
  <Router>
    <Suspense fallback={<LoadingSpinner />}>
      <Routes>
        <Route path="/chat" element={<ChatInterface />} />
        <Route path="/files" element={<FileTree />} />
        <Route path="/git" element={<GitPanel />} />
        <Route path="/tasks" element={<TaskMaster />} />
      </Routes>
    </Suspense>
  </Router>
);
```

#### 1.2 –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤

```typescript
// –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
import { FixedSizeList as List } from 'react-window';

const ProjectList = ({ projects }: { projects: Project[] }) => {
  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => (
    <div style={style}>
      <ProjectItem project={projects[index]} />
    </div>
  );

  return (
    <List
      height={600}
      itemCount={projects.length}
      itemSize={80}
      itemData={projects}
    >
      {Row}
    </List>
  );
};

// –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
const MessageList = ({ messages }: { messages: Message[] }) => {
  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => (
    <div style={style}>
      <MessageItem message={messages[index]} />
    </div>
  );

  return (
    <List
      height={400}
      itemCount={messages.length}
      itemSize={120}
      itemData={messages}
    >
      {Row}
    </List>
  );
};
```

#### 1.3 –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–æ–≤

```typescript
// –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
const ProjectItem = memo(({ project }: { project: Project }) => {
  const handleClick = useCallback(() => {
    onProjectSelect(project);
  }, [project.id]);

  return (
    <div onClick={handleClick}>
      <h3>{project.name}</h3>
      <p>{project.path}</p>
    </div>
  );
});

// –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
const useProjectSelector = () => {
  return useMemo(() => {
    return (state: AppState) => state.projects;
  }, []);
};

// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const ProjectContext = createContext<ProjectContextValue | null>(null);

const ProjectProvider = ({ children }: { children: React.ReactNode }) => {
  const [projects, setProjects] = useState<Project[]>([]);
  const [selectedProject, setSelectedProject] = useState<Project | null>(null);

  const value = useMemo(() => ({
    projects,
    selectedProject,
    setProjects,
    setSelectedProject,
  }), [projects, selectedProject]);

  return (
    <ProjectContext.Provider value={value}>
      {children}
    </ProjectContext.Provider>
  );
};
```

#### 1.4 React Query –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ React Query
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000, // 5 –º–∏–Ω—É—Ç
      cacheTime: 10 * 60 * 1000, // 10 –º–∏–Ω—É—Ç
      retry: 3,
      refetchOnWindowFocus: false,
    },
  },
});

// –•—É–∫–∏ –¥–ª—è API
const useProjects = () => {
  return useQuery({
    queryKey: ['projects'],
    queryFn: fetchProjects,
    staleTime: 5 * 60 * 1000,
  });
};

const useProjectSessions = (projectId: string) => {
  return useQuery({
    queryKey: ['projects', projectId, 'sessions'],
    queryFn: () => fetchProjectSessions(projectId),
    enabled: !!projectId,
  });
};

const useSessionMessages = (sessionId: string) => {
  return useQuery({
    queryKey: ['sessions', sessionId, 'messages'],
    queryFn: () => fetchSessionMessages(sessionId),
    enabled: !!sessionId,
  });
};
```

#### 1.5 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è WebSocket

```typescript
// WebSocket connection pooling
class WebSocketManager {
  private connections = new Map<string, WebSocket>();
  private reconnectAttempts = new Map<string, number>();
  private maxReconnectAttempts = 5;

  connect(url: string): WebSocket {
    if (this.connections.has(url)) {
      return this.connections.get(url)!;
    }

    const ws = new WebSocket(url);
    this.connections.set(url, ws);

    ws.onclose = () => {
      this.handleReconnect(url);
    };

    return ws;
  }

  private handleReconnect(url: string): void {
    const attempts = this.reconnectAttempts.get(url) || 0;

    if (attempts < this.maxReconnectAttempts) {
      setTimeout(
        () => {
          this.reconnectAttempts.set(url, attempts + 1);
          this.connect(url);
        },
        Math.pow(2, attempts) * 1000
      ); // Exponential backoff
    }
  }
}

// Debounced WebSocket messages
const useDebouncedWebSocket = (ws: WebSocket, delay: number = 300) => {
  const debouncedSend = useMemo(
    () =>
      debounce((message: any) => {
        if (ws.readyState === WebSocket.OPEN) {
          ws.send(JSON.stringify(message));
        }
      }, delay),
    [ws, delay]
  );

  return debouncedSend;
};
```

### 2. Backend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### 2.1 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
// Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
import Redis from 'ioredis';

const redis = new Redis(process.env.REDIS_URL);

class CacheService {
  async get<T>(key: string): Promise<T | null> {
    const value = await redis.get(key);
    return value ? JSON.parse(value) : null;
  }

  async set<T>(key: string, value: T, ttl: number = 300): Promise<void> {
    await redis.setex(key, ttl, JSON.stringify(value));
  }

  async invalidate(pattern: string): Promise<void> {
    const keys = await redis.keys(pattern);
    if (keys.length > 0) {
      await redis.del(...keys);
    }
  }
}

// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤
const projectCache = new CacheService();

app.get('/api/projects', async (req, res) => {
  const cacheKey = 'projects:all';

  let projects = await projectCache.get<Project[]>(cacheKey);

  if (!projects) {
    projects = await getProjects();
    await projectCache.set(cacheKey, projects, 300); // 5 –º–∏–Ω—É—Ç
  }

  res.json(projects);
});
```

#### 2.2 –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

```typescript
// Worker threads –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
import { Worker, isMainThread, parentPort, workerData } from 'worker_threads';

if (isMainThread) {
  // Main thread
  const processFileTree = (projectPath: string): Promise<FileTreeItem[]> => {
    return new Promise((resolve, reject) => {
      const worker = new Worker(__filename, {
        workerData: { projectPath },
      });

      worker.on('message', resolve);
      worker.on('error', reject);
      worker.on('exit', code => {
        if (code !== 0) {
          reject(new Error(`Worker stopped with exit code ${code}`));
        }
      });
    });
  };
} else {
  // Worker thread
  const { projectPath } = workerData;

  try {
    const fileTree = await getFileTree(projectPath);
    parentPort?.postMessage(fileTree);
  } catch (error) {
    parentPort?.postMessage({ error: error.message });
  }
}
```

#### 2.3 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```typescript
// Connection pooling
import { Pool } from 'pg';

const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
  max: 20,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});

// Prepared statements
const getProjectById = pool.query('SELECT * FROM projects WHERE id = $1', [projectId]);

// Batch operations
const insertSessions = async (sessions: Session[]) => {
  const client = await pool.connect();

  try {
    await client.query('BEGIN');

    for (const session of sessions) {
      await client.query(
        'INSERT INTO sessions (id, project_id, title, created_at) VALUES ($1, $2, $3, $4)',
        [session.id, session.projectId, session.title, session.createdAt]
      );
    }

    await client.query('COMMIT');
  } catch (error) {
    await client.query('ROLLBACK');
    throw error;
  } finally {
    client.release();
  }
};
```

#### 2.4 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

```typescript
// Streaming –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
import { createReadStream } from 'fs';
import { pipeline } from 'stream/promises';

app.get('/api/projects/:projectName/file', async (req, res) => {
  const { projectName } = req.params;
  const { filePath } = req.query;

  try {
    const fileStream = createReadStream(filePath);

    res.setHeader('Content-Type', 'application/octet-stream');
    res.setHeader('Content-Disposition', `attachment; filename="${path.basename(filePath)}"`);

    await pipeline(fileStream, res);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
const processFilesInParallel = async (filePaths: string[]) => {
  const chunks = chunkArray(filePaths, 10); // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø–æ 10 —Ñ–∞–π–ª–æ–≤

  const results = await Promise.all(chunks.map(chunk => Promise.all(chunk.map(processFile))));

  return results.flat();
};
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 3.1 Frontend –º–µ—Ç—Ä–∏–∫–∏

```typescript
// Performance monitoring
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

const sendToAnalytics = (metric: any) => {
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
  console.log(metric);
};

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
getFCP(sendToAnalytics);
getLCP(sendToAnalytics);
getTTFB(sendToAnalytics);

// Custom performance marks
const measurePerformance = (name: string, fn: () => void) => {
  performance.mark(`${name}-start`);
  fn();
  performance.mark(`${name}-end`);
  performance.measure(name, `${name}-start`, `${name}-end`);
};
```

#### 3.2 Backend –º–µ—Ç—Ä–∏–∫–∏

```typescript
// Response time middleware
app.use((req, res, next) => {
  const start = Date.now();

  res.on('finish', () => {
    const duration = Date.now() - start;
    console.log(`${req.method} ${req.path} - ${res.statusCode} - ${duration}ms`);
  });

  next();
});

// Memory usage monitoring
setInterval(() => {
  const usage = process.memoryUsage();
  console.log('Memory usage:', {
    rss: Math.round(usage.rss / 1024 / 1024) + ' MB',
    heapTotal: Math.round(usage.heapTotal / 1024 / 1024) + ' MB',
    heapUsed: Math.round(usage.heapUsed / 1024 / 1024) + ' MB',
    external: Math.round(usage.external / 1024 / 1024) + ' MB',
  });
}, 30000);
```

## üìä –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### Frontend

- **First Contentful Paint (FCP)**: < 1.5s
- **Largest Contentful Paint (LCP)**: < 2.5s
- **Cumulative Layout Shift (CLS)**: < 0.1
- **Time to Interactive (TTI)**: < 3.5s
- **Bundle size**: < 2MB

### Backend

- **API response time**: < 200ms (95th percentile)
- **WebSocket latency**: < 50ms
- **File processing**: < 1s –¥–ª—è —Ñ–∞–π–ª–æ–≤ < 10MB
- **Memory usage**: < 512MB

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤**: < 500ms
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ —á–∞—Ç–∞**: < 200ms
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–æ–≤**: < 300ms
- **–í—Ä–µ–º—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏**: < 100ms

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### Frontend

- **Webpack Bundle Analyzer** - –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–Ω–¥–ª–∞
- **React DevTools Profiler** - –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Lighthouse** - –∞—É–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Chrome DevTools** - –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Backend

- **Node.js Profiler** - –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ CPU
- **Clinic.js** - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **New Relic/DataDog** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- **Redis** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: Frontend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (1 –Ω–µ–¥–µ–ª—è)

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ code splitting
2. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–æ–≤

### –≠—Ç–∞–ø 2: Backend –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (1 –Ω–µ–¥–µ–ª—è)

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. –£–ª—É—á—à–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –≠—Ç–∞–ø 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (3 –¥–Ω—è)

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ—Ç—Ä–∏–∫
2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [01-architecture.md](./01-architecture.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- [03-security.md](./03-security.md) - –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [07-metrics.md](./07-metrics.md) - –ú–µ—Ç—Ä–∏–∫–∏ –∏ KPI
